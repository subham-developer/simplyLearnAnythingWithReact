{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport React from 'react';\nimport escapeHtml from 'escape-html';\nimport Element from './Element';\nimport StyleFilter from './StyleFilter';\nimport { FILTER_DENY, FILTER_CAST_NUMBER, FILTER_CAST_BOOL, FILTER_NO_CAST, TAGS, BANNED_TAG_LIST, ALLOWED_TAG_LIST, ATTRIBUTES, ATTRIBUTES_TO_PROPS } from './constants';\nvar ELEMENT_NODE = 1;\nvar TEXT_NODE = 3;\nvar INVALID_ROOTS = /^<(!doctype|(html|head|body)(\\s|>))/i;\nvar ALLOWED_ATTRS = /^(aria\\x2D|data\\x2D|[0-9A-Z_a-z\\u017F\\u212A]+:)/i;\nvar OPEN_TOKEN = /\\{\\{\\{(\\w+)\\/?\\}\\}\\}/;\n\nvar Parser = function () {\n  function Parser(markup, props, matchers, filters) {\n    if (props === void 0) {\n      props = {};\n    }\n\n    if (matchers === void 0) {\n      matchers = [];\n    }\n\n    if (filters === void 0) {\n      filters = [];\n    }\n\n    _defineProperty(this, \"allowed\", void 0);\n\n    _defineProperty(this, \"banned\", void 0);\n\n    _defineProperty(this, \"blocked\", void 0);\n\n    _defineProperty(this, \"doc\", void 0);\n\n    _defineProperty(this, \"content\", []);\n\n    _defineProperty(this, \"props\", void 0);\n\n    _defineProperty(this, \"matchers\", void 0);\n\n    _defineProperty(this, \"filters\", void 0);\n\n    _defineProperty(this, \"keyIndex\", void 0);\n\n    if (\"production\" !== process.env.NODE_ENV) {\n      if (markup && typeof markup !== 'string') {\n        throw new TypeError('Interweave parser requires a valid string.');\n      }\n    }\n\n    this.props = props;\n    this.matchers = matchers;\n    this.filters = [].concat(filters, [new StyleFilter()]);\n    this.keyIndex = -1;\n    this.doc = this.createDocument(markup || '');\n    this.allowed = new Set(props.allowList || ALLOWED_TAG_LIST);\n    this.banned = new Set(BANNED_TAG_LIST);\n    this.blocked = new Set(props.blockList);\n  }\n\n  var _proto = Parser.prototype;\n\n  _proto.applyAttributeFilters = function applyAttributeFilters(name, value) {\n    return this.filters.reduce(function (nextValue, filter) {\n      return nextValue !== null && typeof filter.attribute === 'function' ? filter.attribute(name, nextValue) : nextValue;\n    }, value);\n  };\n\n  _proto.applyNodeFilters = function applyNodeFilters(name, node) {\n    return this.filters.reduce(function (nextNode, filter) {\n      return nextNode !== null && typeof filter.node === 'function' ? filter.node(name, nextNode) : nextNode;\n    }, node);\n  };\n\n  _proto.applyMatchers = function applyMatchers(string, parentConfig) {\n    var _this = this;\n\n    var elements = {};\n    var props = this.props;\n    var matchedString = string;\n    var elementIndex = 0;\n    var parts = null;\n    this.matchers.forEach(function (matcher) {\n      var tagName = matcher.asTag().toLowerCase();\n\n      var config = _this.getTagConfig(tagName);\n\n      if (props[matcher.inverseName] || !_this.isTagAllowed(tagName)) {\n        return;\n      }\n\n      if (!_this.canRenderChild(parentConfig, config)) {\n        return;\n      }\n\n      var tokenizedString = '';\n\n      while (matchedString && (parts = matcher.match(matchedString))) {\n        var _parts = parts,\n            index = _parts.index,\n            length = _parts.length,\n            match = _parts.match,\n            valid = _parts.valid,\n            isVoid = _parts.void,\n            partProps = _objectWithoutPropertiesLoose(_parts, [\"index\", \"length\", \"match\", \"valid\", \"void\"]);\n\n        var tokenName = matcher.propName + elementIndex;\n\n        if (index > 0) {\n          tokenizedString += matchedString.slice(0, index);\n        }\n\n        if (valid) {\n          if (isVoid) {\n            tokenizedString += \"{{{\" + tokenName + \"/}}}\";\n          } else {\n            tokenizedString += \"{{{\" + tokenName + \"}}}\" + match + \"{{{/\" + tokenName + \"}}}\";\n          }\n\n          _this.keyIndex += 1;\n          elementIndex += 1;\n          elements[tokenName] = {\n            children: match,\n            matcher: matcher,\n            props: _extends({}, props, {}, partProps, {\n              key: _this.keyIndex\n            })\n          };\n        } else {\n          tokenizedString += match;\n        }\n\n        if (matcher.greedy) {\n          matchedString = tokenizedString + matchedString.slice(index + length);\n          tokenizedString = '';\n        } else {\n          matchedString = matchedString.slice(index + (length || match.length));\n        }\n      }\n\n      if (!matcher.greedy) {\n        matchedString = tokenizedString + matchedString;\n      }\n    });\n\n    if (elementIndex === 0) {\n      return string;\n    }\n\n    return this.replaceTokens(matchedString, elements);\n  };\n\n  _proto.canRenderChild = function canRenderChild(parentConfig, childConfig) {\n    if (!parentConfig.tagName || !childConfig.tagName) {\n      return false;\n    }\n\n    if (parentConfig.void) {\n      return false;\n    }\n\n    if (parentConfig.children.length > 0) {\n      return parentConfig.children.includes(childConfig.tagName);\n    }\n\n    if (parentConfig.invalid.length > 0 && parentConfig.invalid.includes(childConfig.tagName)) {\n      return false;\n    }\n\n    if (childConfig.parent.length > 0) {\n      return childConfig.parent.includes(parentConfig.tagName);\n    }\n\n    if (!parentConfig.self && parentConfig.tagName === childConfig.tagName) {\n      return false;\n    }\n\n    return Boolean(parentConfig && parentConfig.content & childConfig.type);\n  };\n\n  _proto.convertLineBreaks = function convertLineBreaks(markup) {\n    var _this$props = this.props,\n        noHtml = _this$props.noHtml,\n        disableLineBreaks = _this$props.disableLineBreaks;\n\n    if (noHtml || disableLineBreaks || markup.match(/<((?:\\/[a-z ]+)|(?:[a-z ]+\\/))>/gi)) {\n      return markup;\n    }\n\n    var nextMarkup = markup.replace(/\\r\\n/g, '\\n');\n    nextMarkup = nextMarkup.replace(/\\n{3,}/g, '\\n\\n\\n');\n    nextMarkup = nextMarkup.replace(/\\n/g, '<br/>');\n    return nextMarkup;\n  };\n\n  _proto.createDocument = function createDocument(markup) {\n    var doc = document.implementation.createHTMLDocument('Interweave');\n\n    if (markup.match(INVALID_ROOTS)) {\n      if (\"production\" !== process.env.NODE_ENV) {\n        throw new Error('HTML documents as Interweave content are not supported.');\n      }\n    } else {\n      doc.body.innerHTML = this.convertLineBreaks(this.props.escapeHtml ? escapeHtml(markup) : markup);\n    }\n\n    return doc;\n  };\n\n  _proto.extractAttributes = function extractAttributes(node) {\n    var _this2 = this;\n\n    var allowAttributes = this.props.allowAttributes;\n    var attributes = {};\n    var count = 0;\n\n    if (node.nodeType !== ELEMENT_NODE || !node.attributes) {\n      return null;\n    }\n\n    Array.from(node.attributes).forEach(function (attr) {\n      var name = attr.name,\n          value = attr.value;\n      var newName = name.toLowerCase();\n      var filter = ATTRIBUTES[newName] || ATTRIBUTES[name];\n\n      if (!_this2.isSafe(node)) {\n        return;\n      }\n\n      if (!newName.match(ALLOWED_ATTRS)) {\n        if (!allowAttributes && (!filter || filter === FILTER_DENY) || newName.match(/^on/) || value.replace(/(\\s|\\0|&#x0(9|A|D);)/, '').match(/(javascript|vbscript|livescript|xss):/i)) {\n          return;\n        }\n      }\n\n      var newValue = newName === 'style' ? _this2.extractStyleAttribute(node) : value;\n\n      if (filter === FILTER_CAST_BOOL) {\n        newValue = true;\n      } else if (filter === FILTER_CAST_NUMBER) {\n        newValue = parseFloat(String(newValue));\n      } else if (filter !== FILTER_NO_CAST) {\n        newValue = String(newValue);\n      }\n\n      attributes[ATTRIBUTES_TO_PROPS[newName] || newName] = _this2.applyAttributeFilters(newName, newValue);\n      count += 1;\n    });\n\n    if (count === 0) {\n      return null;\n    }\n\n    return attributes;\n  };\n\n  _proto.extractStyleAttribute = function extractStyleAttribute(node) {\n    var styles = {};\n    Array.from(node.style).forEach(function (key) {\n      var value = node.style[key];\n      styles[key.replace(/-([a-z])/g, function (match, letter) {\n        return letter.toUpperCase();\n      })] = value;\n    });\n    return styles;\n  };\n\n  _proto.getTagConfig = function getTagConfig(tagName) {\n    var common = {\n      children: [],\n      content: 0,\n      invalid: [],\n      parent: [],\n      self: true,\n      tagName: '',\n      type: 0,\n      void: false\n    };\n\n    if (TAGS[tagName]) {\n      return _extends({}, common, {}, TAGS[tagName], {\n        tagName: tagName\n      });\n    }\n\n    return common;\n  };\n\n  _proto.isSafe = function isSafe(node) {\n    if (typeof HTMLAnchorElement !== 'undefined' && node instanceof HTMLAnchorElement) {\n      var href = node.getAttribute('href');\n\n      if (href && href.charAt(0) === '#') {\n        return true;\n      }\n\n      var protocol = node.protocol.toLowerCase();\n      return protocol === ':' || protocol === 'http:' || protocol === 'https:' || protocol === 'mailto:' || protocol === 'tel:';\n    }\n\n    return true;\n  };\n\n  _proto.isTagAllowed = function isTagAllowed(tagName) {\n    if (this.banned.has(tagName) || this.blocked.has(tagName)) {\n      return false;\n    }\n\n    return this.props.allowElements || this.allowed.has(tagName);\n  };\n\n  _proto.parse = function parse() {\n    return this.parseNode(this.doc.body, this.getTagConfig('body'));\n  };\n\n  _proto.parseNode = function parseNode(parentNode, parentConfig) {\n    var _this3 = this;\n\n    var _this$props2 = this.props,\n        noHtml = _this$props2.noHtml,\n        noHtmlExceptMatchers = _this$props2.noHtmlExceptMatchers,\n        allowElements = _this$props2.allowElements,\n        transform = _this$props2.transform;\n    var content = [];\n    var mergedText = '';\n    Array.from(parentNode.childNodes).forEach(function (node) {\n      if (node.nodeType === ELEMENT_NODE) {\n        var tagName = node.nodeName.toLowerCase();\n\n        var config = _this3.getTagConfig(tagName);\n\n        if (mergedText) {\n          content.push(mergedText);\n          mergedText = '';\n        }\n\n        var nextNode = _this3.applyNodeFilters(tagName, node);\n\n        if (!nextNode) {\n          return;\n        }\n\n        var children;\n\n        if (transform) {\n          _this3.keyIndex += 1;\n          var _key = _this3.keyIndex;\n          children = _this3.parseNode(nextNode, config);\n          var transformed = transform(nextNode, children, config);\n\n          if (transformed === null) {\n            return;\n          } else if (typeof transformed !== 'undefined') {\n            content.push(React.cloneElement(transformed, {\n              key: _key\n            }));\n            return;\n          }\n\n          _this3.keyIndex = _key - 1;\n        }\n\n        if (_this3.banned.has(tagName)) {\n          return;\n        }\n\n        if (!(noHtml || noHtmlExceptMatchers && tagName !== 'br') && _this3.isTagAllowed(tagName) && (allowElements || _this3.canRenderChild(parentConfig, config))) {\n          _this3.keyIndex += 1;\n\n          var attributes = _this3.extractAttributes(nextNode);\n\n          var elementProps = {\n            tagName: tagName\n          };\n\n          if (attributes) {\n            elementProps.attributes = attributes;\n          }\n\n          if (config.void) {\n            elementProps.selfClose = config.void;\n          }\n\n          content.push(React.createElement(Element, _extends({}, elementProps, {\n            key: _this3.keyIndex\n          }), children || _this3.parseNode(nextNode, config)));\n        } else {\n          content = content.concat(_this3.parseNode(nextNode, config.tagName ? config : parentConfig));\n        }\n      } else if (node.nodeType === TEXT_NODE) {\n        var text = noHtml && !noHtmlExceptMatchers ? node.textContent : _this3.applyMatchers(node.textContent || '', parentConfig);\n\n        if (Array.isArray(text)) {\n          content = content.concat(text);\n        } else {\n          mergedText += text;\n        }\n      }\n    });\n\n    if (mergedText) {\n      content.push(mergedText);\n    }\n\n    return content;\n  };\n\n  _proto.replaceTokens = function replaceTokens(tokenizedString, elements) {\n    if (!tokenizedString.includes('{{{')) {\n      return tokenizedString;\n    }\n\n    var nodes = [];\n    var text = tokenizedString;\n    var open = null;\n\n    while (open = text.match(OPEN_TOKEN)) {\n      var _open = open,\n          match = _open[0],\n          tokenName = _open[1];\n      var startIndex = open.index;\n      var isVoid = match.includes('/');\n\n      if (\"production\" !== process.env.NODE_ENV) {\n        if (!elements[tokenName]) {\n          throw new Error(\"Token \\\"\" + tokenName + \"\\\" found but no matching element to replace with.\");\n        }\n      }\n\n      if (startIndex > 0) {\n        nodes.push(text.slice(0, startIndex));\n        text = text.slice(startIndex);\n      }\n\n      var _elements$tokenName = elements[tokenName],\n          children = _elements$tokenName.children,\n          matcher = _elements$tokenName.matcher,\n          elementProps = _elements$tokenName.props;\n      var endIndex = void 0;\n\n      if (isVoid) {\n        endIndex = match.length;\n        nodes.push(matcher.createElement(children, elementProps));\n      } else {\n        var close = text.match(new RegExp(\"{{{/\" + tokenName + \"}}}\"));\n\n        if (\"production\" !== process.env.NODE_ENV) {\n          if (!close) {\n            throw new Error(\"Closing token missing for interpolated element \\\"\" + tokenName + \"\\\".\");\n          }\n        }\n\n        endIndex = close.index + close[0].length;\n        nodes.push(matcher.createElement(this.replaceTokens(text.slice(match.length, close.index), elements), elementProps));\n      }\n\n      text = text.slice(endIndex);\n    }\n\n    if (text.length > 0) {\n      nodes.push(text);\n    }\n\n    if (nodes.length === 0) {\n      return '';\n    } else if (nodes.length === 1 && typeof nodes[0] === 'string') {\n      return nodes[0];\n    }\n\n    return nodes;\n  };\n\n  return Parser;\n}();\n\nexport { Parser as default };","map":{"version":3,"sources":["/Users/shubhamlal/DevelopmentCodes/simplylearnanythingReact/simplylearn/node_modules/interweave/esm/Parser.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","_defineProperty","obj","value","defineProperty","enumerable","configurable","writable","React","escapeHtml","Element","StyleFilter","FILTER_DENY","FILTER_CAST_NUMBER","FILTER_CAST_BOOL","FILTER_NO_CAST","TAGS","BANNED_TAG_LIST","ALLOWED_TAG_LIST","ATTRIBUTES","ATTRIBUTES_TO_PROPS","ELEMENT_NODE","TEXT_NODE","INVALID_ROOTS","ALLOWED_ATTRS","OPEN_TOKEN","Parser","markup","props","matchers","filters","process","env","NODE_ENV","TypeError","concat","keyIndex","doc","createDocument","allowed","Set","allowList","banned","blocked","blockList","_proto","applyAttributeFilters","name","reduce","nextValue","filter","attribute","applyNodeFilters","node","nextNode","applyMatchers","string","parentConfig","_this","elements","matchedString","elementIndex","parts","forEach","matcher","tagName","asTag","toLowerCase","config","getTagConfig","inverseName","isTagAllowed","canRenderChild","tokenizedString","match","_parts","index","valid","isVoid","void","partProps","tokenName","propName","slice","children","greedy","replaceTokens","childConfig","includes","invalid","parent","self","Boolean","content","type","convertLineBreaks","_this$props","noHtml","disableLineBreaks","nextMarkup","replace","document","implementation","createHTMLDocument","Error","body","innerHTML","extractAttributes","_this2","allowAttributes","attributes","count","nodeType","Array","from","attr","newName","isSafe","newValue","extractStyleAttribute","parseFloat","String","styles","style","letter","toUpperCase","common","HTMLAnchorElement","href","getAttribute","charAt","protocol","has","allowElements","parse","parseNode","parentNode","_this3","_this$props2","noHtmlExceptMatchers","transform","mergedText","childNodes","nodeName","push","_key","transformed","cloneElement","elementProps","selfClose","createElement","text","textContent","isArray","nodes","open","_open","startIndex","_elements$tokenName","endIndex","close","RegExp","default"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport escapeHtml from 'escape-html';\nimport Element from './Element';\nimport StyleFilter from './StyleFilter';\nimport { FILTER_DENY, FILTER_CAST_NUMBER, FILTER_CAST_BOOL, FILTER_NO_CAST, TAGS, BANNED_TAG_LIST, ALLOWED_TAG_LIST, ATTRIBUTES, ATTRIBUTES_TO_PROPS } from './constants';\nvar ELEMENT_NODE = 1;\nvar TEXT_NODE = 3;\nvar INVALID_ROOTS = /^<(!doctype|(html|head|body)(\\s|>))/i;\nvar ALLOWED_ATTRS = /^(aria\\x2D|data\\x2D|[0-9A-Z_a-z\\u017F\\u212A]+:)/i;\nvar OPEN_TOKEN = /\\{\\{\\{(\\w+)\\/?\\}\\}\\}/;\n\nvar Parser = function () {\n  function Parser(markup, props, matchers, filters) {\n    if (props === void 0) {\n      props = {};\n    }\n\n    if (matchers === void 0) {\n      matchers = [];\n    }\n\n    if (filters === void 0) {\n      filters = [];\n    }\n\n    _defineProperty(this, \"allowed\", void 0);\n\n    _defineProperty(this, \"banned\", void 0);\n\n    _defineProperty(this, \"blocked\", void 0);\n\n    _defineProperty(this, \"doc\", void 0);\n\n    _defineProperty(this, \"content\", []);\n\n    _defineProperty(this, \"props\", void 0);\n\n    _defineProperty(this, \"matchers\", void 0);\n\n    _defineProperty(this, \"filters\", void 0);\n\n    _defineProperty(this, \"keyIndex\", void 0);\n\n    if (\"production\" !== process.env.NODE_ENV) {\n      if (markup && typeof markup !== 'string') {\n        throw new TypeError('Interweave parser requires a valid string.');\n      }\n    }\n\n    this.props = props;\n    this.matchers = matchers;\n    this.filters = [].concat(filters, [new StyleFilter()]);\n    this.keyIndex = -1;\n    this.doc = this.createDocument(markup || '');\n    this.allowed = new Set(props.allowList || ALLOWED_TAG_LIST);\n    this.banned = new Set(BANNED_TAG_LIST);\n    this.blocked = new Set(props.blockList);\n  }\n\n  var _proto = Parser.prototype;\n\n  _proto.applyAttributeFilters = function applyAttributeFilters(name, value) {\n    return this.filters.reduce(function (nextValue, filter) {\n      return nextValue !== null && typeof filter.attribute === 'function' ? filter.attribute(name, nextValue) : nextValue;\n    }, value);\n  };\n\n  _proto.applyNodeFilters = function applyNodeFilters(name, node) {\n    return this.filters.reduce(function (nextNode, filter) {\n      return nextNode !== null && typeof filter.node === 'function' ? filter.node(name, nextNode) : nextNode;\n    }, node);\n  };\n\n  _proto.applyMatchers = function applyMatchers(string, parentConfig) {\n    var _this = this;\n\n    var elements = {};\n    var props = this.props;\n    var matchedString = string;\n    var elementIndex = 0;\n    var parts = null;\n    this.matchers.forEach(function (matcher) {\n      var tagName = matcher.asTag().toLowerCase();\n\n      var config = _this.getTagConfig(tagName);\n\n      if (props[matcher.inverseName] || !_this.isTagAllowed(tagName)) {\n        return;\n      }\n\n      if (!_this.canRenderChild(parentConfig, config)) {\n        return;\n      }\n\n      var tokenizedString = '';\n\n      while (matchedString && (parts = matcher.match(matchedString))) {\n        var _parts = parts,\n            index = _parts.index,\n            length = _parts.length,\n            match = _parts.match,\n            valid = _parts.valid,\n            isVoid = _parts.void,\n            partProps = _objectWithoutPropertiesLoose(_parts, [\"index\", \"length\", \"match\", \"valid\", \"void\"]);\n\n        var tokenName = matcher.propName + elementIndex;\n\n        if (index > 0) {\n          tokenizedString += matchedString.slice(0, index);\n        }\n\n        if (valid) {\n          if (isVoid) {\n            tokenizedString += \"{{{\" + tokenName + \"/}}}\";\n          } else {\n            tokenizedString += \"{{{\" + tokenName + \"}}}\" + match + \"{{{/\" + tokenName + \"}}}\";\n          }\n\n          _this.keyIndex += 1;\n          elementIndex += 1;\n          elements[tokenName] = {\n            children: match,\n            matcher: matcher,\n            props: _extends({}, props, {}, partProps, {\n              key: _this.keyIndex\n            })\n          };\n        } else {\n          tokenizedString += match;\n        }\n\n        if (matcher.greedy) {\n          matchedString = tokenizedString + matchedString.slice(index + length);\n          tokenizedString = '';\n        } else {\n          matchedString = matchedString.slice(index + (length || match.length));\n        }\n      }\n\n      if (!matcher.greedy) {\n        matchedString = tokenizedString + matchedString;\n      }\n    });\n\n    if (elementIndex === 0) {\n      return string;\n    }\n\n    return this.replaceTokens(matchedString, elements);\n  };\n\n  _proto.canRenderChild = function canRenderChild(parentConfig, childConfig) {\n    if (!parentConfig.tagName || !childConfig.tagName) {\n      return false;\n    }\n\n    if (parentConfig.void) {\n      return false;\n    }\n\n    if (parentConfig.children.length > 0) {\n      return parentConfig.children.includes(childConfig.tagName);\n    }\n\n    if (parentConfig.invalid.length > 0 && parentConfig.invalid.includes(childConfig.tagName)) {\n      return false;\n    }\n\n    if (childConfig.parent.length > 0) {\n      return childConfig.parent.includes(parentConfig.tagName);\n    }\n\n    if (!parentConfig.self && parentConfig.tagName === childConfig.tagName) {\n      return false;\n    }\n\n    return Boolean(parentConfig && parentConfig.content & childConfig.type);\n  };\n\n  _proto.convertLineBreaks = function convertLineBreaks(markup) {\n    var _this$props = this.props,\n        noHtml = _this$props.noHtml,\n        disableLineBreaks = _this$props.disableLineBreaks;\n\n    if (noHtml || disableLineBreaks || markup.match(/<((?:\\/[a-z ]+)|(?:[a-z ]+\\/))>/gi)) {\n      return markup;\n    }\n\n    var nextMarkup = markup.replace(/\\r\\n/g, '\\n');\n    nextMarkup = nextMarkup.replace(/\\n{3,}/g, '\\n\\n\\n');\n    nextMarkup = nextMarkup.replace(/\\n/g, '<br/>');\n    return nextMarkup;\n  };\n\n  _proto.createDocument = function createDocument(markup) {\n    var doc = document.implementation.createHTMLDocument('Interweave');\n\n    if (markup.match(INVALID_ROOTS)) {\n      if (\"production\" !== process.env.NODE_ENV) {\n        throw new Error('HTML documents as Interweave content are not supported.');\n      }\n    } else {\n      doc.body.innerHTML = this.convertLineBreaks(this.props.escapeHtml ? escapeHtml(markup) : markup);\n    }\n\n    return doc;\n  };\n\n  _proto.extractAttributes = function extractAttributes(node) {\n    var _this2 = this;\n\n    var allowAttributes = this.props.allowAttributes;\n    var attributes = {};\n    var count = 0;\n\n    if (node.nodeType !== ELEMENT_NODE || !node.attributes) {\n      return null;\n    }\n\n    Array.from(node.attributes).forEach(function (attr) {\n      var name = attr.name,\n          value = attr.value;\n      var newName = name.toLowerCase();\n      var filter = ATTRIBUTES[newName] || ATTRIBUTES[name];\n\n      if (!_this2.isSafe(node)) {\n        return;\n      }\n\n      if (!newName.match(ALLOWED_ATTRS)) {\n        if (!allowAttributes && (!filter || filter === FILTER_DENY) || newName.match(/^on/) || value.replace(/(\\s|\\0|&#x0(9|A|D);)/, '').match(/(javascript|vbscript|livescript|xss):/i)) {\n          return;\n        }\n      }\n\n      var newValue = newName === 'style' ? _this2.extractStyleAttribute(node) : value;\n\n      if (filter === FILTER_CAST_BOOL) {\n        newValue = true;\n      } else if (filter === FILTER_CAST_NUMBER) {\n        newValue = parseFloat(String(newValue));\n      } else if (filter !== FILTER_NO_CAST) {\n        newValue = String(newValue);\n      }\n\n      attributes[ATTRIBUTES_TO_PROPS[newName] || newName] = _this2.applyAttributeFilters(newName, newValue);\n      count += 1;\n    });\n\n    if (count === 0) {\n      return null;\n    }\n\n    return attributes;\n  };\n\n  _proto.extractStyleAttribute = function extractStyleAttribute(node) {\n    var styles = {};\n    Array.from(node.style).forEach(function (key) {\n      var value = node.style[key];\n      styles[key.replace(/-([a-z])/g, function (match, letter) {\n        return letter.toUpperCase();\n      })] = value;\n    });\n    return styles;\n  };\n\n  _proto.getTagConfig = function getTagConfig(tagName) {\n    var common = {\n      children: [],\n      content: 0,\n      invalid: [],\n      parent: [],\n      self: true,\n      tagName: '',\n      type: 0,\n      void: false\n    };\n\n    if (TAGS[tagName]) {\n      return _extends({}, common, {}, TAGS[tagName], {\n        tagName: tagName\n      });\n    }\n\n    return common;\n  };\n\n  _proto.isSafe = function isSafe(node) {\n    if (typeof HTMLAnchorElement !== 'undefined' && node instanceof HTMLAnchorElement) {\n      var href = node.getAttribute('href');\n\n      if (href && href.charAt(0) === '#') {\n        return true;\n      }\n\n      var protocol = node.protocol.toLowerCase();\n      return protocol === ':' || protocol === 'http:' || protocol === 'https:' || protocol === 'mailto:' || protocol === 'tel:';\n    }\n\n    return true;\n  };\n\n  _proto.isTagAllowed = function isTagAllowed(tagName) {\n    if (this.banned.has(tagName) || this.blocked.has(tagName)) {\n      return false;\n    }\n\n    return this.props.allowElements || this.allowed.has(tagName);\n  };\n\n  _proto.parse = function parse() {\n    return this.parseNode(this.doc.body, this.getTagConfig('body'));\n  };\n\n  _proto.parseNode = function parseNode(parentNode, parentConfig) {\n    var _this3 = this;\n\n    var _this$props2 = this.props,\n        noHtml = _this$props2.noHtml,\n        noHtmlExceptMatchers = _this$props2.noHtmlExceptMatchers,\n        allowElements = _this$props2.allowElements,\n        transform = _this$props2.transform;\n    var content = [];\n    var mergedText = '';\n    Array.from(parentNode.childNodes).forEach(function (node) {\n      if (node.nodeType === ELEMENT_NODE) {\n        var tagName = node.nodeName.toLowerCase();\n\n        var config = _this3.getTagConfig(tagName);\n\n        if (mergedText) {\n          content.push(mergedText);\n          mergedText = '';\n        }\n\n        var nextNode = _this3.applyNodeFilters(tagName, node);\n\n        if (!nextNode) {\n          return;\n        }\n\n        var children;\n\n        if (transform) {\n          _this3.keyIndex += 1;\n          var _key = _this3.keyIndex;\n          children = _this3.parseNode(nextNode, config);\n          var transformed = transform(nextNode, children, config);\n\n          if (transformed === null) {\n            return;\n          } else if (typeof transformed !== 'undefined') {\n            content.push(React.cloneElement(transformed, {\n              key: _key\n            }));\n            return;\n          }\n\n          _this3.keyIndex = _key - 1;\n        }\n\n        if (_this3.banned.has(tagName)) {\n          return;\n        }\n\n        if (!(noHtml || noHtmlExceptMatchers && tagName !== 'br') && _this3.isTagAllowed(tagName) && (allowElements || _this3.canRenderChild(parentConfig, config))) {\n          _this3.keyIndex += 1;\n\n          var attributes = _this3.extractAttributes(nextNode);\n\n          var elementProps = {\n            tagName: tagName\n          };\n\n          if (attributes) {\n            elementProps.attributes = attributes;\n          }\n\n          if (config.void) {\n            elementProps.selfClose = config.void;\n          }\n\n          content.push(React.createElement(Element, _extends({}, elementProps, {\n            key: _this3.keyIndex\n          }), children || _this3.parseNode(nextNode, config)));\n        } else {\n          content = content.concat(_this3.parseNode(nextNode, config.tagName ? config : parentConfig));\n        }\n      } else if (node.nodeType === TEXT_NODE) {\n        var text = noHtml && !noHtmlExceptMatchers ? node.textContent : _this3.applyMatchers(node.textContent || '', parentConfig);\n\n        if (Array.isArray(text)) {\n          content = content.concat(text);\n        } else {\n          mergedText += text;\n        }\n      }\n    });\n\n    if (mergedText) {\n      content.push(mergedText);\n    }\n\n    return content;\n  };\n\n  _proto.replaceTokens = function replaceTokens(tokenizedString, elements) {\n    if (!tokenizedString.includes('{{{')) {\n      return tokenizedString;\n    }\n\n    var nodes = [];\n    var text = tokenizedString;\n    var open = null;\n\n    while (open = text.match(OPEN_TOKEN)) {\n      var _open = open,\n          match = _open[0],\n          tokenName = _open[1];\n      var startIndex = open.index;\n      var isVoid = match.includes('/');\n\n      if (\"production\" !== process.env.NODE_ENV) {\n        if (!elements[tokenName]) {\n          throw new Error(\"Token \\\"\" + tokenName + \"\\\" found but no matching element to replace with.\");\n        }\n      }\n\n      if (startIndex > 0) {\n        nodes.push(text.slice(0, startIndex));\n        text = text.slice(startIndex);\n      }\n\n      var _elements$tokenName = elements[tokenName],\n          children = _elements$tokenName.children,\n          matcher = _elements$tokenName.matcher,\n          elementProps = _elements$tokenName.props;\n      var endIndex = void 0;\n\n      if (isVoid) {\n        endIndex = match.length;\n        nodes.push(matcher.createElement(children, elementProps));\n      } else {\n        var close = text.match(new RegExp(\"{{{/\" + tokenName + \"}}}\"));\n\n        if (\"production\" !== process.env.NODE_ENV) {\n          if (!close) {\n            throw new Error(\"Closing token missing for interpolated element \\\"\" + tokenName + \"\\\".\");\n          }\n        }\n\n        endIndex = close.index + close[0].length;\n        nodes.push(matcher.createElement(this.replaceTokens(text.slice(match.length, close.index), elements), elementProps));\n      }\n\n      text = text.slice(endIndex);\n    }\n\n    if (text.length > 0) {\n      nodes.push(text);\n    }\n\n    if (nodes.length === 0) {\n      return '';\n    } else if (nodes.length === 1 && typeof nodes[0] === 'string') {\n      return nodes[0];\n    }\n\n    return nodes;\n  };\n\n  return Parser;\n}();\n\nexport { Parser as default };"]},"metadata":{},"sourceType":"module"}